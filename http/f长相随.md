## 长相随 —— 基于HTTP的功能追加协议

### 协议瓶颈：
- 基于TCP：所以也继承了缺点
- 影响HTTP请求的因素：带宽，延迟
- 一条连接上只可发送一个请求。
- 请求只能从客户端开始。客户端不可以接收除响应以外的指令。
- 请求 / 响应首部未经压缩就发送。首部信息越多延迟越大。
- 发送冗长的首部。每次互相发送相同的首部造成的浪费较多。
- 可任意选择数据压缩格式。非强制压缩发送。
### WebSocket之前的解决方法
- ajax轮询获取最新消息
- Long poll：阻塞模型，没有获取到消息就不关闭链接

### 双向通信的WebSocket
- WebSocket与HTTP：有交集但不是全部
- 特点：
- 持久化协议
- 被动变为主动：主动推送数据
- 减少通信量（头部信息）
- 实时性优势


### 探索式的实践-SPDY：谷歌提出：为了更快，最小化网络延迟
- 优点（解决 http 的缺陷）：
- 多路复用，赋予请求优先级。
- 支持服务器推送技术。
- SPDY 压缩了 HTTP 头。
- 强制使用了 SSL 传输协议。
- 现实意义的好处：页面效率提升。
- 但是被 http2.0 取代了。谷歌全面支持 http2.0

### HTTP2.0 - 2015年
> SPDY升级版
- 新特点：
- 性能增强核心：二进制分帧技术
![二进制分帧](./img/二进制分帧.jpg)
- 首部压缩缓存：首部表跟踪和存储，变动的首部，会被添加。由客户端和服务端渐进更新
- 多路复用：把请求分成一个个帧
![多路复用](./img/多路复用.jpg)
- 单链接多资源的优势：减少服务链接压力，改善网络拥塞状况，拥塞和丢包恢复更快。
- 请求优先级：高优先级的流优先发送，优先级不是绝对的，不同优先级混合也是必须的

> ps：当http2.0普及的时候，雪碧图，文件合并等，就没有太大的意义了

### 大跃进： QUIC 与 HTTP3.0
![QUIC](./img/QUIC.jpg)
- 抛弃TCP
- HTTP2.0的问题：
- 队头阻塞：多路复用情况下，丢包。整个TCP都要等待重传（性能不如HTTP.1）
- 建立链接握手延迟大：
- QUIC特性：
- 0 RTT 
- 没有队头阻塞的多路复用
- 减少丢包（前向纠错）